#!/bin/sh

#  -e exit immediatley if a simple command  exits with non-zero
#  -u treat unset variables as errors in parameter expressions
#  -C prevent output redirection
set -euC

attach() {
    [ -n "${TMUX:-}" ] &&
        tmux switch-client -t  '=data-types' ||
        tmux attach-session -t '=data-types'
}

if tmux has-session -t '=data-types' 2> /dev/null; then
    attach
    exit 0
fi

# -d prevent tmux to attach the new session
# -s session name
# -n window name (a new tmux session always need atleast 1 window)
tmux new-session -d -s data-types
tmux new-window -d -t '=data-types'
tmux split-window -d -h
tmux send-keys -t '=data-types:1' 'git log --oneline | head' Enter
tmux send-keys -t '=data-types:1.right' 'npm run test-watch' Enter
